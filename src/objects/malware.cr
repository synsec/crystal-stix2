require "json"
require "./properties/common_object_properties"
require "./properties/name"
require "./properties/description"
require "./properties/kill_chain_phases"
require "../macro/create_methods"

class STIX2::Malware
  include JSON::Serializable
  include STIX2::Properties::CommonObjectProperties
  include STIX2::Properties::NameProperty
  include STIX2::Properties::DescriptionProperty
  include STIX2::Properties::KillChainPhasesProperty
  include STIX2::Properties::AliasesProperty
  include STIX2::Properties::SeenProperties
  include STIX2::Macro::CreateMethods

  setter malware_types : Array(String)
  property is_family : Bool
  setter os_execution_envs : Array(String)?
  setter architecture_execution_envs : Array(String)?
  setter implementation_languages : Array(String)?
  setter capabilities : Array(String)?
  setter sample_refs : Array(String)?

  def initialize(@malware_types : Array(String), @is_family = false)
    init_object("malware")
  end

  def initialize(args : NamedTuple(malware_types: Array(String), is_family: Bool))
    @is_family = args[:is_family]
    @malware_types = args[:malware_types]
    init_object("malware")
  end

  define_add_methods malware_types
  define_add_methods os_execution_envs
  define_add_methods architecture_execution_envs
  define_add_methods implementation_languages
  define_add_methods capabilities
  define_add_methods sample_refs
end
