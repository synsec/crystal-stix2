<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="generator" content="Crystal Docs 0.30.1">


<link href="css/style.css" rel="stylesheet" type="text/css">

<script type="text/javascript" src="js/doc.js"></script>
<script type="text/javascript">
  CrystalDoc.base_path = "";
</script>

  <meta id="repository-name" content="github.com/synsec/crystal-stix2">
  <title>README - github.com/synsec/crystal-stix2</title>
</head>
<body>

<div class="sidebar">
  <div class="sidebar-header">
    <div class="search-box">
      <input type="search" class="search-input" placeholder="Search..." spellcheck="false" aria-label="Search">
    </div>

    <div class="repository-links">
      <a href="index.html">README</a>
    </div>
  </div>

  <div class="search-results" class="hidden">
    <ul class="search-list"></ul>
  </div>

  <div class="types-list">
    <ul>
  
  <li class=" " data-id="github.com/synsec/crystal-stix2/Array" data-name="array(t)">
      <a href="Array.html">Array</a>
      
    </li>
  
  <li class=" " data-id="github.com/synsec/crystal-stix2/OV" data-name="ov">
      <a href="OV.html">OV</a>
      
    </li>
  
  <li class="parent " data-id="github.com/synsec/crystal-stix2/STIX2" data-name="stix2">
      <a href="STIX2.html">STIX2</a>
      
        <ul>
  
  <li class=" " data-id="github.com/synsec/crystal-stix2/STIX2/AttackPattern" data-name="stix2::attackpattern">
      <a href="STIX2/AttackPattern.html">AttackPattern</a>
      
    </li>
  
  <li class=" " data-id="github.com/synsec/crystal-stix2/STIX2/Bundle" data-name="stix2::bundle">
      <a href="STIX2/Bundle.html">Bundle</a>
      
    </li>
  
  <li class=" " data-id="github.com/synsec/crystal-stix2/STIX2/Constants" data-name="stix2::constants">
      <a href="STIX2/Constants.html">Constants</a>
      
    </li>
  
  <li class=" " data-id="github.com/synsec/crystal-stix2/STIX2/DomainName" data-name="stix2::domainname">
      <a href="STIX2/DomainName.html">DomainName</a>
      
    </li>
  
  <li class=" " data-id="github.com/synsec/crystal-stix2/STIX2/ExternalReference" data-name="stix2::externalreference">
      <a href="STIX2/ExternalReference.html">ExternalReference</a>
      
    </li>
  
  <li class=" " data-id="github.com/synsec/crystal-stix2/STIX2/GranularMarking" data-name="stix2::granularmarking">
      <a href="STIX2/GranularMarking.html">GranularMarking</a>
      
    </li>
  
  <li class=" " data-id="github.com/synsec/crystal-stix2/STIX2/Identity" data-name="stix2::identity">
      <a href="STIX2/Identity.html">Identity</a>
      
    </li>
  
  <li class=" " data-id="github.com/synsec/crystal-stix2/STIX2/Indicator" data-name="stix2::indicator">
      <a href="STIX2/Indicator.html">Indicator</a>
      
    </li>
  
  <li class=" " data-id="github.com/synsec/crystal-stix2/STIX2/Infrastructure" data-name="stix2::infrastructure">
      <a href="STIX2/Infrastructure.html">Infrastructure</a>
      
    </li>
  
  <li class=" " data-id="github.com/synsec/crystal-stix2/STIX2/IPv4Addr" data-name="stix2::ipv4addr">
      <a href="STIX2/IPv4Addr.html">IPv4Addr</a>
      
    </li>
  
  <li class=" " data-id="github.com/synsec/crystal-stix2/STIX2/KillChainPhase" data-name="stix2::killchainphase">
      <a href="STIX2/KillChainPhase.html">KillChainPhase</a>
      
    </li>
  
  <li class="parent " data-id="github.com/synsec/crystal-stix2/STIX2/Macro" data-name="stix2::macro">
      <a href="STIX2/Macro.html">Macro</a>
      
        <ul>
  
  <li class=" " data-id="github.com/synsec/crystal-stix2/STIX2/Macro/CreateMethods" data-name="stix2::macro::createmethods">
      <a href="STIX2/Macro/CreateMethods.html">CreateMethods</a>
      
    </li>
  
</ul>

      
    </li>
  
  <li class=" " data-id="github.com/synsec/crystal-stix2/STIX2/Malware" data-name="stix2::malware">
      <a href="STIX2/Malware.html">Malware</a>
      
    </li>
  
  <li class="parent " data-id="github.com/synsec/crystal-stix2/STIX2/Properties" data-name="stix2::properties">
      <a href="STIX2/Properties.html">Properties</a>
      
        <ul>
  
  <li class=" " data-id="github.com/synsec/crystal-stix2/STIX2/Properties/AliasesProperty" data-name="stix2::properties::aliasesproperty">
      <a href="STIX2/Properties/AliasesProperty.html">AliasesProperty</a>
      
    </li>
  
  <li class=" " data-id="github.com/synsec/crystal-stix2/STIX2/Properties/BasicCommon" data-name="stix2::properties::basiccommon">
      <a href="STIX2/Properties/BasicCommon.html">BasicCommon</a>
      
    </li>
  
  <li class=" " data-id="github.com/synsec/crystal-stix2/STIX2/Properties/Common" data-name="stix2::properties::common">
      <a href="STIX2/Properties/Common.html">Common</a>
      
    </li>
  
  <li class=" " data-id="github.com/synsec/crystal-stix2/STIX2/Properties/Core" data-name="stix2::properties::core">
      <a href="STIX2/Properties/Core.html">Core</a>
      
    </li>
  
  <li class=" " data-id="github.com/synsec/crystal-stix2/STIX2/Properties/DescriptionProperty" data-name="stix2::properties::descriptionproperty">
      <a href="STIX2/Properties/DescriptionProperty.html">DescriptionProperty</a>
      
    </li>
  
  <li class=" " data-id="github.com/synsec/crystal-stix2/STIX2/Properties/ExternalReferencesProperty" data-name="stix2::properties::externalreferencesproperty">
      <a href="STIX2/Properties/ExternalReferencesProperty.html">ExternalReferencesProperty</a>
      
    </li>
  
  <li class=" " data-id="github.com/synsec/crystal-stix2/STIX2/Properties/KillChainPhasesProperty" data-name="stix2::properties::killchainphasesproperty">
      <a href="STIX2/Properties/KillChainPhasesProperty.html">KillChainPhasesProperty</a>
      
    </li>
  
  <li class=" " data-id="github.com/synsec/crystal-stix2/STIX2/Properties/LabelsProperty" data-name="stix2::properties::labelsproperty">
      <a href="STIX2/Properties/LabelsProperty.html">LabelsProperty</a>
      
    </li>
  
  <li class=" " data-id="github.com/synsec/crystal-stix2/STIX2/Properties/LangProperty" data-name="stix2::properties::langproperty">
      <a href="STIX2/Properties/LangProperty.html">LangProperty</a>
      
    </li>
  
  <li class=" " data-id="github.com/synsec/crystal-stix2/STIX2/Properties/MarkingProperty" data-name="stix2::properties::markingproperty">
      <a href="STIX2/Properties/MarkingProperty.html">MarkingProperty</a>
      
    </li>
  
  <li class=" " data-id="github.com/synsec/crystal-stix2/STIX2/Properties/NameProperty" data-name="stix2::properties::nameproperty">
      <a href="STIX2/Properties/NameProperty.html">NameProperty</a>
      
    </li>
  
  <li class=" " data-id="github.com/synsec/crystal-stix2/STIX2/Properties/SCOCommonObjectProperties" data-name="stix2::properties::scocommonobjectproperties">
      <a href="STIX2/Properties/SCOCommonObjectProperties.html">SCOCommonObjectProperties</a>
      
    </li>
  
  <li class=" " data-id="github.com/synsec/crystal-stix2/STIX2/Properties/SeenProperties" data-name="stix2::properties::seenproperties">
      <a href="STIX2/Properties/SeenProperties.html">SeenProperties</a>
      
    </li>
  
  <li class=" " data-id="github.com/synsec/crystal-stix2/STIX2/Properties/ValueProperty" data-name="stix2::properties::valueproperty">
      <a href="STIX2/Properties/ValueProperty.html">ValueProperty</a>
      
    </li>
  
</ul>

      
    </li>
  
  <li class=" " data-id="github.com/synsec/crystal-stix2/STIX2/Relationship" data-name="stix2::relationship">
      <a href="STIX2/Relationship.html">Relationship</a>
      
    </li>
  
  <li class="parent " data-id="github.com/synsec/crystal-stix2/STIX2/Type" data-name="stix2::type">
      <a href="STIX2/Type.html">Type</a>
      
        <ul>
  
  <li class=" " data-id="github.com/synsec/crystal-stix2/STIX2/Type/BundleObjects" data-name="stix2::type::bundleobjects">
      <a href="STIX2/Type/BundleObjects.html">BundleObjects</a>
      
    </li>
  
  <li class=" " data-id="github.com/synsec/crystal-stix2/STIX2/Type/Dictionary" data-name="stix2::type::dictionary">
      <a href="STIX2/Type/Dictionary.html">Dictionary</a>
      
    </li>
  
  <li class=" " data-id="github.com/synsec/crystal-stix2/STIX2/Type/DictionaryItem" data-name="stix2::type::dictionaryitem">
      <a href="STIX2/Type/DictionaryItem.html">DictionaryItem</a>
      
    </li>
  
</ul>

      
    </li>
  
  <li class=" " data-id="github.com/synsec/crystal-stix2/STIX2/Url" data-name="stix2::url">
      <a href="STIX2/Url.html">Url</a>
      
    </li>
  
</ul>

      
    </li>
  
</ul>

  </div>
</div>


<div class="main-content">
<h1>crystal-stix2</h1>

<p><img src="https://github.com/synsec/crystal-stix2/workflows/Crystal%20CI/badge.svg?branch=master" alt=""/>
<a href="https://synsec.github.io/crystal-stix2/" target="_blank"><img src="https://img.shields.io/badge/cryatsl--stix2-docs-brightgreen" alt=""/></a></p>

<p>crystal-stix2 is a STIX 2.1 implementation using Crystal language. This is a work in progress and API is likely to change.</p>

<p><a href="https://synsec.github.io/crystal-stix2/" target="_blank">Read crystal-stix2 docs</a></p>

<p>Structured Threat Information Expression (STIX) is a language for expressing cyber threat and observable information. This document defines concepts that apply across all of STIX and defines the overall structure of the STIX language.</p>

<p>STIX 2.1 documentation is available at <a href="http://docs.oasis-open.org/cti/stix/v2.1/stix-v2.1.html" target="_blank">http://docs.oasis-open.org/cti/stix/v2.1/stix-v2.1.html</a></p>

<h2>Installation</h2>

<ol><li>Add the dependency to your <code>shard.yml</code>:</li></ol>

<p><code></code>`yaml
   dependencies:</p>

<pre><code> crystal<span class="o">-</span>stix2:
   github: synsec<span class="s">/crystal-stix2.git</code></pre>

<p><code></code>`</p>

<ol><li>Run <code>shards install</code></li></ol>

<h2>Usage</h2>

<pre><code class="language-crystal"><span class="k">require</span> <span class="s">&quot;crystal-stix2&quot;</span>

bundle <span class="o">=</span> <span class="t">STIX2</span><span class="t">::</span><span class="t">Bundle</span>.<span class="k">new</span>

indicator <span class="o">=</span> <span class="t">STIX2</span><span class="t">::</span><span class="t">Indicator</span>.<span class="k">new</span>({
      indicator_types: [
        <span class="s">&quot;compromised&quot;</span>,
        <span class="s">&quot;malicious-activity&quot;</span>
      ],
      pattern:         <span class="s">&quot;[ ipv4-addr:value = &#39;192.0.2.0&#39; ]&quot;</span>,
      pattern_type:    <span class="s">&quot;stix&quot;</span>,
      valid_from:      <span class="s">&quot;2019-11-26T04:34:56.715000000Z&quot;</span>,
    })
    
indicator.name <span class="o">=</span> <span class="s">&quot;SSH attacker&quot;</span>
indicator.labels <span class="o">=</span> [<span class="s">&quot;malicious-activity&quot;</span>]
indicator.labels <span class="o">&lt;&lt;</span> [<span class="s">&quot;ip-watchlist&quot;</span>]

malware <span class="o">=</span> <span class="t">STIX2</span><span class="t">::</span><span class="t">Malware</span>.<span class="k">new</span>({
      malware_types: [<span class="s">&quot;ransomware&quot;</span>],
      is_family:     <span class="n">false</span>,
    })

relationship <span class="o">=</span> <span class="t">STIX2</span><span class="t">::</span><span class="t">Relationship</span>.<span class="k">new</span>({
      relationship_type: <span class="s">&quot;indicates&quot;</span>,
      source_ref:        indicator.id.to_s,
      target_ref:        malware.id.to_s,
    })

bundle.objects <span class="o">&lt;&lt;</span> [malware, indicator]
bundle.objects <span class="o">&lt;&lt;</span> relationship
</code></pre>

<h2>Features</h2>

<p>Below is a list of features which have been implemented:</p>

<p>STIX Domain Objects</p>

<ul><li>[x] Attack Pattern</li><li>[ ] Campaign</li><li>[ ] Course of Action</li><li>[ ] Grouping</li><li>[x] Identity</li><li>[x] Indicator</li><li>[x] Infrastructure</li><li>[ ] Intrusion Set</li><li>[ ] Location</li><li>[x] Malware</li><li>[ ] Malware Analysis</li><li>[ ] Note</li><li>[ ] Observed Data</li><li>[ ] Opinion</li><li>[ ] Report</li><li>[ ] Threat Actor</li><li>[ ] Tool</li><li>[ ] Vulnerability</li></ul>

<p>STIX Relationship Objects</p>

<ul><li>[x] Relationship</li><li>[ ] Sighting</li></ul>

<p>STIX Cyber-observable Objects</p>

<ul><li>[ ] Artifact Object</li><li>[ ] AS Object</li><li>[ ] Directory Object</li><li>[x] Domain Name Object</li><li>[ ] ​Email Address Object</li><li>[ ] ​Email Message Object</li><li>[ ] ​File Object</li><li>[x] ​IPv4 Address Object</li><li>[ ] ​IPv6 Address Object</li><li>[ ] ​MAC Address Object</li><li>[ ] ​Mutex Object</li><li>[ ] ​Network Traffic Object</li><li>[ ] ​Process Object</li><li>[ ] ​Software Object</li><li>[x] ​URL Object</li><li>[ ] ​User Account Object</li><li>[ ] ​Windows Registry Key Object</li><li>[ ] ​X.509 Certificate Object</li></ul>

<p>Other STIX Objects</p>

<ul><li>[x] Bundle</li><li>[ ] Language Content</li><li>[ ] Marking Definition</li></ul>

<h2>Development</h2>

<p><span class="flag orange">TODO</span>  Write development instructions here</p>

<h2>Contributing</h2>

<ol><li>Fork it (&lt;https://github.com/synsec/crystal-stix2/fork>)</li><li>Create your feature branch (<code>git checkout -b my-new-feature</code>)</li><li>Commit your changes (<code>git commit -am 'Add some feature'</code>)</li><li>Push to the branch (<code>git push origin my-new-feature</code>)</li><li>Create a new Pull Request</li></ol>

<h2>Contributors</h2>

<ul><li><a href="https://github.com/jaysneg" target="_blank">Oleksii Morozov</a> - creator and maintainer</li></ul>
</div>
</body>
</html>
